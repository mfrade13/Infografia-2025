{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Nancy\\\\Documents\\\\UNIVERSIDAD\\\\SEPTIMO_SEMESTRE\\\\INFOGRAFIA\\\\object-detection-app\\\\frontend\\\\src\\\\components\\\\WebcamDetector.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport Webcam from 'react-webcam';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction WebcamDetector({\n  onDetection\n}) {\n  _s();\n  const [isDetecting, setIsDetecting] = useState(false);\n  const [fps, setFps] = useState(2); // Frames por segundo\n  const webcamRef = useRef(null);\n  const canvasRef = useRef(null);\n  const detectionInterval = useRef(null);\n  const captureAndDetect = async () => {\n    if (!webcamRef.current || !canvasRef.current) return;\n    const imageSrc = webcamRef.current.getScreenshot();\n    if (!imageSrc) return;\n    try {\n      // Convertir data URL a Blob\n      const blob = await fetch(imageSrc).then(res => res.blob());\n      const formData = new FormData();\n      formData.append('file', blob, 'webcam.jpg');\n      const response = await axios.post('http://localhost:5000/upload', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n\n      // Dibujar resultados en el canvas\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      const img = new Image();\n      img.onload = () => {\n        // Ajustar canvas al tama침o del video\n        canvas.width = webcamRef.current.video.videoWidth;\n        canvas.height = webcamRef.current.video.videoHeight;\n\n        // Dibujar imagen\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n        // Dibujar cajas de detecci칩n\n        response.data.results.forEach(obj => {\n          const [x1, y1, x2, y2] = obj.box;\n          ctx.strokeStyle = '#00FF00';\n          ctx.lineWidth = 2;\n          ctx.strokeRect(x1, y1, x2 - x1, y2 - y1);\n          ctx.fillStyle = '#00FF00';\n          ctx.font = '16px Arial';\n          ctx.fillText(`${obj.label} (${(obj.confidence * 100).toFixed(0)}%)`, x1, y1 > 20 ? y1 - 5 : y1 + 20);\n        });\n      };\n      img.src = `http://localhost:5000${response.data.processed_image}`;\n      if (onDetection) {\n        onDetection({\n          results: response.data.results,\n          imageUrl: `http://localhost:5000${response.data.processed_image}`\n        });\n      }\n    } catch (error) {\n      console.error('Detection error:', error);\n    }\n  };\n  const toggleDetection = () => {\n    if (isDetecting) {\n      clearInterval(detectionInterval.current);\n      detectionInterval.current = null;\n    } else {\n      detectionInterval.current = setInterval(captureAndDetect, 1000 / fps);\n    }\n    setIsDetecting(!isDetecting);\n  };\n  useEffect(() => {\n    return () => {\n      if (detectionInterval.current) {\n        clearInterval(detectionInterval.current);\n      }\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"webcam-detector\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Real-time Detection\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'relative'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Webcam, {\n        ref: webcamRef,\n        audio: false,\n        screenshotFormat: \"image/jpeg\",\n        style: {\n          display: 'block'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        style: {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          pointerEvents: 'none'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleDetection,\n        children: isDetecting ? 'Stop Detection' : 'Start Detection'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"FPS: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: \"1\",\n          max: \"10\",\n          value: fps,\n          onChange: e => setFps(parseInt(e.target.value)),\n          disabled: isDetecting\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\" \", fps]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n_s(WebcamDetector, \"CbX7WIBs2BEIj5FeDBh+5a3Lapw=\");\n_c = WebcamDetector;\nexport default WebcamDetector;\nvar _c;\n$RefreshReg$(_c, \"WebcamDetector\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Webcam","axios","jsxDEV","_jsxDEV","WebcamDetector","onDetection","_s","isDetecting","setIsDetecting","fps","setFps","webcamRef","canvasRef","detectionInterval","captureAndDetect","current","imageSrc","getScreenshot","blob","fetch","then","res","formData","FormData","append","response","post","headers","canvas","ctx","getContext","img","Image","onload","width","video","videoWidth","height","videoHeight","drawImage","data","results","forEach","obj","x1","y1","x2","y2","box","strokeStyle","lineWidth","strokeRect","fillStyle","font","fillText","label","confidence","toFixed","src","processed_image","imageUrl","error","console","toggleDetection","clearInterval","setInterval","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","position","ref","audio","screenshotFormat","display","top","left","pointerEvents","onClick","type","min","max","value","onChange","e","parseInt","target","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Nancy/Documents/UNIVERSIDAD/SEPTIMO_SEMESTRE/INFOGRAFIA/object-detection-app/frontend/src/components/WebcamDetector.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport Webcam from 'react-webcam';\r\nimport axios from 'axios';\r\n\r\nfunction WebcamDetector({ onDetection }) {\r\n  const [isDetecting, setIsDetecting] = useState(false);\r\n  const [fps, setFps] = useState(2); // Frames por segundo\r\n  const webcamRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const detectionInterval = useRef(null);\r\n\r\n  const captureAndDetect = async () => {\r\n    if (!webcamRef.current || !canvasRef.current) return;\r\n    \r\n    const imageSrc = webcamRef.current.getScreenshot();\r\n    if (!imageSrc) return;\r\n\r\n    try {\r\n      // Convertir data URL a Blob\r\n      const blob = await fetch(imageSrc).then(res => res.blob());\r\n      const formData = new FormData();\r\n      formData.append('file', blob, 'webcam.jpg');\r\n\r\n      const response = await axios.post('http://localhost:5000/upload', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data'\r\n        }\r\n      });\r\n\r\n      // Dibujar resultados en el canvas\r\n      const canvas = canvasRef.current;\r\n      const ctx = canvas.getContext('2d');\r\n      const img = new Image();\r\n      \r\n      img.onload = () => {\r\n        // Ajustar canvas al tama침o del video\r\n        canvas.width = webcamRef.current.video.videoWidth;\r\n        canvas.height = webcamRef.current.video.videoHeight;\r\n        \r\n        // Dibujar imagen\r\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n        \r\n        // Dibujar cajas de detecci칩n\r\n        response.data.results.forEach(obj => {\r\n          const [x1, y1, x2, y2] = obj.box;\r\n          ctx.strokeStyle = '#00FF00';\r\n          ctx.lineWidth = 2;\r\n          ctx.strokeRect(x1, y1, x2 - x1, y2 - y1);\r\n          \r\n          ctx.fillStyle = '#00FF00';\r\n          ctx.font = '16px Arial';\r\n          ctx.fillText(`${obj.label} (${(obj.confidence * 100).toFixed(0)}%)`, x1, y1 > 20 ? y1 - 5 : y1 + 20);\r\n        });\r\n      };\r\n      \r\n      img.src = `http://localhost:5000${response.data.processed_image}`;\r\n      \r\n      if (onDetection) {\r\n        onDetection({\r\n          results: response.data.results,\r\n          imageUrl: `http://localhost:5000${response.data.processed_image}`\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Detection error:', error);\r\n    }\r\n  };\r\n\r\n  const toggleDetection = () => {\r\n    if (isDetecting) {\r\n      clearInterval(detectionInterval.current);\r\n      detectionInterval.current = null;\r\n    } else {\r\n      detectionInterval.current = setInterval(captureAndDetect, 1000 / fps);\r\n    }\r\n    setIsDetecting(!isDetecting);\r\n  };\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (detectionInterval.current) {\r\n        clearInterval(detectionInterval.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"webcam-detector\">\r\n      <h2>Real-time Detection</h2>\r\n      <div style={{ position: 'relative' }}>\r\n        <Webcam\r\n          ref={webcamRef}\r\n          audio={false}\r\n          screenshotFormat=\"image/jpeg\"\r\n          style={{ display: 'block' }}\r\n        />\r\n        <canvas\r\n          ref={canvasRef}\r\n          style={{\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            pointerEvents: 'none'\r\n          }}\r\n        />\r\n      </div>\r\n      <div>\r\n        <button onClick={toggleDetection}>\r\n          {isDetecting ? 'Stop Detection' : 'Start Detection'}\r\n        </button>\r\n        <div>\r\n          <label>FPS: </label>\r\n          <input \r\n            type=\"range\" \r\n            min=\"1\" \r\n            max=\"10\" \r\n            value={fps} \r\n            onChange={(e) => setFps(parseInt(e.target.value))}\r\n            disabled={isDetecting}\r\n          />\r\n          <span> {fps}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default WebcamDetector;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}